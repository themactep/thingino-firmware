config BR2_PACKAGE_THINGINO_STREAMER
	bool "Thingino Streamer"
	select BR2_PACKAGE_INGENIC_LIB
	select BR2_PACKAGE_JSON_C
	select BR2_PACKAGE_LIBWEBSOCKETS
	depends on !(BR2_SOC_FAMILY_INGENIC_A1)
	help
	  Video streamer for Ingenic T-series.
	  Now uses JSON configuration format with json-c library.

	  https://github.com/themactep/thingino-streamer

config BR2_PACKAGE_THINGINO_STREAMER_AUDIO
	bool "Audio module support"
	depends on BR2_PACKAGE_THINGINO_STREAMER
	help
	  Enable audio capture and streaming module for Thingino Streamer.
	  Adds audio input, encoding and RTSP audio streaming capabilities.

	  Supported codecs: G.711A, G.711U
	  Audio capture: 8kHz, 16kHz, 48kHz sample rates
	  Additional memory usage: ~1-2MB for audio processing

config BR2_PACKAGE_THINGINO_STREAMER_AUDIO_CODECS
	bool "Audio codecs support"
	depends on BR2_PACKAGE_THINGINO_STREAMER
	depends on BR2_PACKAGE_FAAC
	depends on BR2_PACKAGE_THINGINO_OPUS
	depends on BR2_PACKAGE_LIBHELIX_AAC
	help
	  Enable additional audio codecs for Thingino Streamer audio module.
	  Adds support for AAC, OPUS, and PCM audio encoding formats.
	  Additional memory usage: ~100KB for codec libraries

config BR2_PACKAGE_THINGINO_STREAMER_HTTP
	bool "HTTP API server module support"
	depends on BR2_PACKAGE_THINGINO_STREAMER
	default y
	help
	  Enable HTTP API server module with endpoints for monitoring, media access, and ONVIF.
	  Provides comprehensive HTTP API with JSON endpoints, snapshot access, and MJPEG streaming.
	  Includes configurable endpoint control and performance tuning options.

	  Features: JSON API endpoints, snapshot/MJPEG streaming, configurable security
	  Endpoints: /status.json, /snap0.jpg, /stream0.mjpeg, /metrics, /onvif/*
	  Additional memory usage: ~100KB for HTTP server and request handling

config BR2_PACKAGE_THINGINO_STREAMER_IMAGE_GRAB
	bool "Image grabbing module support"
	depends on BR2_PACKAGE_THINGINO_STREAMER
	default y
	help
	  Enable image grabbing module for capturing JPEG, NV12, and YUV frames.
	  Provides programmatic access to capture still images from video streams
	  with support for multiple formats and configurable quality settings.

	  Features: JPEG/NV12/YUV capture, configurable quality, thread-safe operation
	  Use cases: Snapshot capture, image processing, computer vision applications
	  Additional memory usage: ~50KB for frame capture and format conversion

config BR2_PACKAGE_THINGINO_STREAMER_IMP_CONTROL
	bool "IMP image quality control module support"
	depends on BR2_PACKAGE_THINGINO_STREAMER
	default y
	help
	  Enable IMP image quality control module with HTTP API endpoints.
	  Provides real-time control of image quality parameters including
	  brightness, contrast, saturation, and sharpness via HTTP API.

	  Features: Real-time IMP parameter control, HTTP API endpoints, parameter validation
	  Endpoints: /imp/params.json (GET), /imp/params (POST), /imp/reset (POST)
	  Additional memory usage: ~50KB for parameter management and API handling

config BR2_PACKAGE_THINGINO_STREAMER_METRICS
	bool "System metrics module support"
	depends on BR2_PACKAGE_THINGINO_STREAMER
	default y
	help
	  Enable system metrics collection and HTTP endpoints for monitoring.
	  Collects process, stream, and system metrics with configurable intervals.
	  Provides Prometheus metrics, JSON status, and health check endpoints.

	  Features: CPU/memory monitoring, stream statistics, HTTP endpoints
	  Endpoints: /metrics, /status.json, /health.json, /info.json
	  Additional memory usage: ~200KB for metrics collection and history

config BR2_PACKAGE_THINGINO_STREAMER_MOTION
	bool "Motion detection module support"
	depends on BR2_PACKAGE_THINGINO_STREAMER
	default y
	help
	  Enable IVS-based motion detection module with configurable ROI regions.
	  Provides hardware-accelerated motion detection using Ingenic IVS (Intelligent Video Surveillance).
	  Supports multiple regions of interest, sensitivity control, and script execution on motion events.

	  Features: Hardware-accelerated detection, configurable ROI regions, script execution
	  IVS support: Uses Ingenic IMP_IVS motion detection algorithms
	  Additional memory usage: ~150KB for IVS processing and motion state management

config BR2_PACKAGE_THINGINO_STREAMER_ONVIF
	bool "ONVIF protocol support"
	depends on BR2_PACKAGE_THINGINO_STREAMER
	default y
	help
	  Enable ONVIF protocol support with WS-Discovery and SOAP services.
	  Adds device discovery, snapshot retrieval, and stream URI services.

	  Features: WS-Discovery, Device/Media services, SOAP endpoints
	  Standards compliance: ONVIF Profile S compatible
	  Additional memory usage: ~500KB for ONVIF services

config BR2_PACKAGE_THINGINO_STREAMER_OSD
	bool "OSD timestamp overlay module support"
	depends on BR2_PACKAGE_THINGINO_STREAMER
	select BR2_PACKAGE_LIBSCHRIFT
	default y
	help
	  Enable OSD (On-Screen Display) timestamp overlay module with dedicated update thread.
	  Provides real-time timestamp overlays on video streams with precise timing control.
	  Only updates OSD when RTSP clients are connected to conserve system resources.

	  Features: Real-time timestamp overlay, client-aware updates, dedicated thread
	  Timing: Precise 1-second intervals, independent of frame processing
	  Additional memory usage: ~50KB for OSD processing and thread management

config BR2_PACKAGE_THINGINO_STREAMER_PHOTOSENSING
	bool "Photosensing module support"
	depends on BR2_PACKAGE_THINGINO_STREAMER
	default y
	help
	  Enable automatic day/night mode switching based on light conditions.
	  Monitors ISO values and white balance statistics to automatically
	  switch between day and night ISP modes and control IR cut filter.

	  Features: Automatic mode switching, IR cut filter control, configurable thresholds
	  Hardware support: GPIO-based IR cut filter control (gpio79/gpio80)
	  Additional memory usage: ~100KB for photosensing processing

config BR2_PACKAGE_THINGINO_STREAMER_RTSP
	bool "RTSP streaming server module support"
	depends on BR2_PACKAGE_THINGINO_STREAMER
	default y
	help
	  Enable RTSP streaming server module for real-time video streaming.
	  Provides RFC-compliant RTSP server with H.264/H.265 video streaming,
	  multi-client support, and optional authentication.

	  Features: RTSP/RTP streaming, multi-client support, H.264/H.265 codecs
	  Standards: RFC 2326 (RTSP), RFC 3984 (H.264 RTP), RFC 7798 (H.265 RTP)
	  Additional memory usage: ~200KB for RTSP server and client management

config BR2_PACKAGE_THINGINO_STREAMER_RTSPS
	bool "RTSPS (RTSP over TLS) secure streaming support"
	depends on BR2_PACKAGE_THINGINO_STREAMER_RTSP
	depends on BR2_PACKAGE_THINGINO_STREAMER_TLS_OPENSSL || BR2_PACKAGE_THINGINO_STREAMER_TLS_MBEDTLS
	default y
	help
	  Enable RTSPS (RTSP over TLS/SSL) for secure encrypted video streaming.
	  Provides encrypted RTSP connections using the same TLS backend as RTMPS.
	  Supports both server certificates and optional client authentication.

	  Features: Encrypted RTSP streaming, TLS 1.2+, certificate support
	  Security: End-to-end encryption, optional client verification
	  Additional memory usage: ~100KB for TLS contexts and encryption
	  Default port: 322 (RTSPS standard port)

config BR2_PACKAGE_THINGINO_STREAMER_RTMP_CLIENT
	bool "RTMP streaming client module support"
	depends on BR2_PACKAGE_THINGINO_STREAMER
	default y
	help
	  Enable RTMP streaming client module for live streaming to platforms.
	  Provides RTMP client for pushing camera streams to YouTube Live, Twitch,
	  Facebook Live, and other RTMP ingest servers for live broadcasting.

	  Features: RTMP client, multi-platform streaming, H.264/H.265 support
	  Platforms: YouTube Live, Twitch, Facebook Live, custom RTMP servers
	  Additional memory usage: ~250KB for RTMP protocol and connection handling

config BR2_PACKAGE_THINGINO_STREAMER_RTMP_SERVER
	bool "RTMP streaming server module support"
	depends on BR2_PACKAGE_THINGINO_STREAMER
	default y
	help
	  Enable RTMP streaming server module for receiving live streams.
	  Provides RTMP server for receiving streams from OBS/FFmpeg and other
	  RTMP clients for local recording, testing, and development purposes.

	  Features: RTMP server, multi-client support, H.264/H.265 support
	  Use cases: Local recording, development testing, backup streams
	  Additional memory usage: ~200KB for RTMP protocol and connection handling

if BR2_PACKAGE_THINGINO_STREAMER_RTMP_CLIENT || BR2_PACKAGE_THINGINO_STREAMER_RTSP

choice
	prompt "TLS/SSL backend for RTMPS support"
	default BR2_PACKAGE_THINGINO_STREAMER_TLS_NONE if !BR2_PACKAGE_OPENSSL && !BR2_PACKAGE_MBEDTLS
	default BR2_PACKAGE_THINGINO_STREAMER_TLS_OPENSSL if BR2_PACKAGE_OPENSSL
	default BR2_PACKAGE_THINGINO_STREAMER_TLS_MBEDTLS if BR2_PACKAGE_MBEDTLS
	help
	  Choose TLS/SSL backend for RTMPS (encrypted RTMP) support.
	  Most modern streaming platforms require RTMPS for security.

config BR2_PACKAGE_THINGINO_STREAMER_TLS_NONE
	bool "No TLS support (plain RTMP only)"
	help
	  Disable TLS support. Only plain RTMP connections will work.
	  This reduces memory usage but limits platform compatibility.

config BR2_PACKAGE_THINGINO_STREAMER_TLS_OPENSSL
	bool "OpenSSL"
	depends on BR2_PACKAGE_OPENSSL
	help
	  Use OpenSSL for TLS support. Best compatibility with other libraries.
	  Recommended for most users. Supports all major streaming platforms.

config BR2_PACKAGE_THINGINO_STREAMER_TLS_MBEDTLS
	bool "mbedTLS"
	depends on BR2_PACKAGE_MBEDTLS
	help
	  Use mbedTLS for TLS support. Smaller footprint than OpenSSL.
	  May conflict with libwebsockets in some buildroot versions.

endchoice

endif

config BR2_PACKAGE_THINGINO_STREAMER_WEBRTC
	bool "WebRTC support"
	depends on BR2_PACKAGE_THINGINO_STREAMER
	depends on BR2_TOOLCHAIN_HAS_THREADS
	depends on !BR2_STATIC_LIBS
	select BR2_PACKAGE_LIBPEER
	help
	  Enable WebRTC real-time streaming support for Thingino Streamer.
	  Adds WebRTC peer-to-peer streaming capabilities using libpeer.

	  This feature allows direct browser-to-camera streaming without
	  requiring RTSP clients, enabling modern web applications to
	  access camera streams directly.

	  Dependencies: libpeer (includes wolfSSL, libsrtp)
	  Additional memory usage: ~2-4MB per WebRTC connection

comment "WebRTC support needs a toolchain w/ threads, dynamic library"
	depends on BR2_PACKAGE_THINGINO_STREAMER && (!BR2_TOOLCHAIN_HAS_THREADS || BR2_STATIC_LIBS)
